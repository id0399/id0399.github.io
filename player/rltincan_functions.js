/*!
 * ActivePresenter HTML5 Output File
 * Copyright (c) Atomi Systems, Inc. All rights reserved.
 * https://atomisystems.com/activepresenter/
 * Version: 7.5.6
 * Date: 2019.03.28
 */
!function(e){var t,n=e.ControlKind,a=e.ControlType,i=e.ResponseResult,r=e.PlayModes,c=e.logDebug,s=!1,o=0,u="http://adlnet.gov/expapi/verbs/completed",d="http://adlnet.gov/expapi/verbs/experienced",f="http://adlnet.gov/expapi/verbs/attempted",l="http://adlnet.gov/expapi/verbs/answered",p="http://adlnet.gov/expapi/verbs/passed",v="http://adlnet.gov/expapi/verbs/failed",h="bookmark",b="suspend_data";function k(){return!!t||(c("Could not find API"),!1)}function S(e){var t,n;return e-=t=e%60,"PT"+((e-=n=e%3600)%3600!=0?0:e/3600)+"H"+(n%60!=0?0:n/60)+"M"+t+"S"}function m(e,t){var n={},a=t.ui.Fs,i=a.Os;switch(e){case u:n[i]=a.text("completed");break;case d:n[i]=a.text("experienced");break;case f:n[i]=a.text("attempted");break;case l:n[i]=a.text("answered");break;case p:n[i]=a.text("passed");break;case v:n[i]=a.text("failed");break;default:n[i]=a.text("voided")}return{id:e,display:n}}function w(e,n){if(!k())return"";var a;try{a=t.setState(e,n,{callback:function(){c("tincanSetStateData OK")}})}catch(e){c("tincanSetStateData failed - "+e.message)}return a}function g(e){if(!k())return"";var n="",a=t.getState(e);return null!==a.state&&(n=a.state.contents),n}function x(e,t,n){var a=t;(void 0==a||a<0)&&(a=0);var r={},c={};switch(r.raw=a,e!=i.Ii&&(c.score=r),c.completion=!1,c.success=!1,c.response=n,e){case i.Ai:break;case i.Ii:case i.Ci:c.completion=!0,c.success=!0;break;case i.Ri:c.completion=!0,c.success=!1}return c}function M(e,t,i){switch(e){case n.S:return i?"long-fill-in":"fill-in";case n.C:return"matching";case n.L:switch(t){case a.it:case a.J:case a.tt:return"choice";case a.nt:return"sequencing";case a.et:return"performance";case a.ht:return"matching";case a.rt:return"likert";default:return""}return"";default:return"performance"}return""}function D(e,t,i,r,c){var s,o,u,d="";switch(i){case n.S:u=c?4e3:250,(d=e).length>u&&(d=d.substr(0,u));break;case n.C:d=e+"[.]"+t;break;case n.L:switch(r){case a.it:case a.J:case a.tt:case a.nt:for(d="",s=0,o=e.length||0;s<o;++s)""!=d&&(d+="[,]"),d+=e[s];break;case a.et:case a.ht:var f,l=[];for(f in e)e.hasOwnProperty(f)&&l.push(f);for(l.sort(),d="",s=0,o=l.length;s<o;++s)""!=d&&(d+="[,]"),d+=l[s]+"[.]"+e[l[s]];break;case a.rt:d=parseInt(e[t])+1}}return d}var y=e.createClass({$init:function(e){this.Ls=e},initialize:function(){var e=this.Ls.Cs;try{t=new TinCan({url:window.location.href,recordStores:e.xAPIRecordStores,activity:{id:e.xAPICourseId,definition:{name:e.xAPICourseName,description:e.xAPICourseDescription}}}),c("tincanInitialize - successful.")}catch(e){return void c("tincanInitialize - failed: "+JSON.stringify(e))}0!==t.recordStores.length||c("tincanInitialize - failed: No LRS")},terminate:function(){if(0!=s){var e,n,a={verb:"",result:{}},i=this.Ls,o=(i.Cs.options,r[i.options.playMode]);if(o==r.Tutorial||o==r.Practice||o==r.Test){e=i.score(),n=i.maxScore(),a.verb=m(f,i);var u={};u.min=Math.round(0),u.scale=e/n,u.raw=e>0?Math.round(e):0,u.max=Math.round(n),a.result.score=u,a.result.duration=S(Math.ceil(i.elapsedTime()/1e3)),a.result.completion=!1}else a.verb=m(f,i),a.result.completion=!1,a.result.duration=S(Math.ceil(i.elapsedTime()/1e3));k()&&t.sendStatement(a,function(e,t){null===e[0].err?c("tincanTerminate - successful"):c("tincanTerminate - failed: "+e[0].err.responseText+" ("+e[0].err.status+")")})}},startLesson:function(){s||(s=!0,k()&&t.sendStatement({verb:m(f,this.Ls)},function(e,t){null===e[0].err?c("tincanStartLesson - successful"):c("tincanStartLesson - failed: "+e[0].err.responseText+" ("+e[0].err.status+")")}))},endLesson:function(e){if(0!=s){s=!1;var n,a,i,o={verb:"",result:{}},d=this.Ls,f=(d.Cs.options,r[d.options.playMode]);f==r.Tutorial||f==r.Practice||f==r.Test?(n=d.score(),a=d.maxScore(),i=d.result(),o.verb=m(i?p:v,d),score={},score.min=Math.round(0),score.scale=a>0?n/a:0,score.raw=n>0?Math.round(n):0,score.max=Math.round(a),o.result.score=score,o.result.success=i,o.result.duration=S(Math.ceil(d.elapsedTime()/1e3)),o.result.completion=!0):(o.verb=m(u,d),o.result.completion=!0,o.result.success=i,o.result.duration=S(Math.ceil(d.elapsedTime()/1e3))),k()&&t.sendStatement(o,function(e,t){null===e[0].err?c("tincanEndLesson - successful"):c("tincanEndLesson - failed: "+e[0].err.responseText+" ("+e[0].err.status+")")})}},loadSuspendData:function(){if(c("tincanLoadSuspendData"),""!=g(h)){var e=g(b);if(""!=e)try{var t=JSON.parse(e);t.info&&t.info instanceof Object&&(this.Ls.Ps=t.info,o=t.info.ts||0)}catch(e){c("Invalid suspend data!")}}},storeSuspendData:function(e,t){c("tincanStoreSuspendData");var n={};n.info=e;try{var a=JSON.stringify(n);w(b,a)}catch(e){c("Serialization suspend data error, session restore will not avaiable!")}o=e.ts||0},getSuspendDataTS:function(){return o},storeInteractionData:function(e,s,o,u,d){if(k()){var f=r[this.Ls.options.playMode],p=this.Ls.ui.Fs.Os;if(f==r.Tutorial||f==r.Practice||f==r.Test){var v,h,b,S,w,g=[];if(e.kind==n.L&&e.type==a.rt)for(b in u)u.hasOwnProperty(b)&&g.push(b);else b=e.reportid,g.push(b);for(S=0,w=g.length;S<w;++S){b=g[S];var y,I,L={},T=[],z=t.activity.id+"/"+b;if(s!=i.Ii)for(v=0;v<(d.length||0);++v)""!=(h=D(d[v],b,e.kind,e.type,e.multiline))&&T.push(h);L[p]=e.name,y={id:z,definition:{description:L,type:"http://adlnet.gov/expapi/activities/cmi.interaction",interactionType:M(e.kind,e.type,e.multiline),correctResponsesPattern:T}},I={verb:m(l,this.Ls),object:y,context:{contextActivities:{parent:t.activity}},result:x(s,o,D(u,b,e.kind,e.type,e.multiline))},t.sendStatement(I,function(e,t){null===e[0].err||c("storeInteractionData - failed: "+e[0].err.responseText+" ("+e[0].err.status+")")})}}this.storeSuspendData(this.Ls.Ps)}},setBookmark:function(e,n,a){c("tincanSetBookmark");var i=e,r={},s={},o=this.Ls.ui.Fs.Os;if(""==i&&(i="Slide "+a),r[o]=e,s[o]=n,k())return t.sendStatement({verb:m(d,this.Ls),object:{id:t.activity.id+"/"+a,definition:{name:r,description:s}},context:{contextActivities:{parent:t.activity}}},function(e,t){null===e[0].err?c("tincanSetBookmark - sending statement success"):c("tincanSetBookmark - sending statement - err: "+e[0].err)}),w(h,a)}});e.LMS=y}(window.AtomiAP=window.AtomiAP||{});